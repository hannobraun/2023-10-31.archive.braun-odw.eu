[build]
publish = "public"
command = "zola build"

[build.environment]
ZOLA_VERSION = "0.14.1"

[context.deploy-preview]
command = "zola build --base-url $DEPLOY_PRIME_URL"

[dev]
framework  = "#custom"
# TASK: This points to my local Zola fork. Switch back to upstream version, once
#       the next version is released. It will supposedly contain this pull
#       request:
#       https://github.com/getzola/zola/pull/1564
#       Which will supposedly fix the bug I fixed here:
#       https://github.com/getzola/zola/pull/1620
command    = "/home/hanno/.cargo/bin/zola serve"
targetPort = 1111


# Custom headers

[[headers]]
  for = "/*"
  [headers.values]
    Content-Security-Policy = "default-src 'none'; img-src 'self'; script-src 'self'; style-src 'self'; frame-ancestors 'none'; base-uri 'none'; form-action 'self' https://*.braun-odw.eu https://*.sibforms.com"
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "DENY"


# Page redirects

[[redirects]]
from   = "/"
to     = "/updates"
status = 302 # temporary redirect
force  = true

[[redirects]]
from   = "/products"
to     = "/products/spacer"
status = 302 # temporary redirect
force  = true

[[redirects]]
from   = "/project/*"
to     = "/notes/:splat"
status = 301 # moved permanently
force  = true

[[redirects]]
from   = "/projects/*"
to     = "/notes/:splat"
status = 301 # moved permanently
force  = true

[[redirects]]
from   = "rss.xml"
to     = "atom.xml"
status = 301 # moved permanently
force  = true


# Domain redirects

[[redirects]]
from   = "https://madeby.hannobraun.de/*"
to     = "https://made-by.braun-odw.eu/:splat"
status = 301
force  = true

[[redirects]]
from   = "https://madebyhanno.netlify.app/*"
to     = "https://made-by.braun-odw.eu/:splat"
status = 301
force  = true
